{% extends 'voting/header.html' %}

{% block content %}
{% include "voting/includes/status.html" %}

{% load static %}
<script src="{% static 'js/myVotes.js' %}" defer></script>   
<hr>
<br>


<h1>VotingPage</h1>

<form id="search">
  <label>go to number:<input id="number" name="number"></label>
  <input type="submit" value="Submit">
</form>

{% comment %} iterate over all creations in the formList {% endcomment %}
{% for formListItems in formList %}
  <h2>({{formListItems.creation.id}}) {{ formListItems.creation.name }} | number: {{formListItems.creation.number}}</h2>
  
  <img src="{{ formListItems.creation.image.url }}" alt="..."  width="250" height="250">
  {% comment %} iterate over the carehoryforms dictionary (so all data for one creation: forms and vote per category) {% endcomment %}
  {% for key, value in formListItems.categoryForms.items %}
    <h3 id="creation_{{formListItems.creation.number}}">{{key}}</h3>
 
    <form method="post" novalidate oninput="submit()" id="voteformtagid">
      {% csrf_token %}  

      <div class="voteform" id="voteform">
          {% for radio in value.form.vote %}
            <input name="vote"
            type="radio" 
            id="crea_{{formListItems.creation.id}}_cat_{{key}}_{{radio.id_for_label}}"  
            value="{{ forloop.counter }}"
            {% if forloop.counter == value.vote %}checked{% endif %}>
            <label for="crea_{{formListItems.creation.id}}_cat_{{key}}_{{radio.id_for_label}}">{{ radio.choice_label }}</label>
            {% endfor %}
            <div>
              <input type="hidden" name="creationId" value="{{ formListItems.creation.id }}">
            </div>
            (id: {{ formListItems.creation.id }} - catVote: {{value.vote}})
            <div>
              <input type="hidden" name="category" value="{{key}}">
            </div>
          </div>
          {% comment %} <button type="submit">Submit</button> {% endcomment %}
    </form> 
    {% endfor %}
{% endfor %}




<div id="end">
  end
</div>
{% endblock %}